<div class="p-0 sm:p-4 my-auto mx-auto flex max-w-screen-lg items-center justify-center">
  <div class="rounded-3xl bg-gradient-to-r from-white via-teal-500 to-white p-0.5">
    <div class="rounded-3xl bg-white shadow shadow-violet-300">
      <form method="POST" action="/" class="grid flex-1 grid-cols-1 gap-4 p-4 md:grid-cols-2 lg:grid-cols-2 accent-teal-500">
        <div class="w-full px-4 pt-4 pb-1 sm:px-8 sm:pt-8 sm:pb-2">
          <div class="mb-4">
            <label class="mb-2 block font-bold text-gray-700" for="age">Please type in your age:</label>
            <input
              class="focus:shadow-outline w-full appearance-none rounded border py-2 px-3 leading-tight text-gray-700 shadow focus:outline-none"
              id="age"
              type="number"
              name="age"
              placeholder="Enter your age" />
          </div>
          <div class="mb-4">
            <label class="mb-2 block font-bold text-gray-700" for="ethnicity">Please select your ethnic background:</label>
            <select
              class="focus:shadow-outline w-full appearance-none rounded border py-2 px-3 leading-tight text-gray-700 shadow focus:outline-none"
              name="ethnicity"
              id="ethnicity">
              <option value="0" selected disabled hidden>Please choose your option</option>
              <option value="1">Aboriginal or Torres Strait Islander</option>
              <option value="2">African</option>
              <option value="3">European or other Caucasian</option>
              <option value="4">East Asian e.g. Chinese, Hong Konger</option>
              <option value="5">South Asian e.g. Indian, Bangladeshi</option>
              <option value="6">Southeast Asian e.g. Thai, Vietnamese</option>
              <option value="7">Middle Eastern</option>
              <option value="8">Hispanic</option>
              <option value="9">Pacific Islander</option>
              <option value="10">Mixed</option>
              <option value="11">My ethnic background is not listed here</option>
              <option value="12">I prefer not to say</option>
            </select>
          </div>
          <div class="mb-4">
            <label class="mb-2 block font-bold text-gray-700" for="gender">Please select your gender:</label>
            <select
              class="focus:shadow-outline w-full appearance-none rounded border py-2 px-3 leading-tight text-gray-700 shadow focus:outline-none"
              name="gender"
              id="gender">
              <option value="0" selected disabled hidden>Please choose your option</option>
              <option value="1">Female</option>
              <option value="2">Male</option>
              <option value="3">Non-binary</option>
              <option value="4">My gender is not listed here</option>
              <option value="5">I prefer not to say</option>
            </select>
          </div>
        </div>
        <div class="px-4 pt-4 pb-1 sm:px-8 sm:pt-8 sm:pb-2">
          {{ form.hidden_tag() }}
          <div class="mb-4">
            <label class="mb-2 block font-bold text-gray-700" for="username"> Username<span class="text-red-500">*</span></label>
            <input
              class="focus:shadow-outline w-full appearance-none rounded border py-2 px-3 leading-tight text-gray-700 shadow focus:outline-none"
              id="username"
              maxlength="15"
              minlength="5"
              type="text"
              name="username"
              required
              placeholder="Enter your username" />
            <div class="text-sm text-red-400" id="username-status"></div>
          </div>
          <div class="mb-4">
            <label class="mb-2 block font-bold text-gray-700" for="password">Password<span class="text-red-500">*</span> </label>
            <input
              class="focus:shadow-outline w-full appearance-none rounded border py-2 px-3 leading-tight text-gray-700 shadow focus:outline-none"
              id="password"
              maxlength="15"
              minlength="5"
              name="password"
              type="password"
              required
              placeholder="Enter your password" />
          </div>
          <div class="mb-4">
            <label class="mb-2 block font-bold text-gray-700" for="password_repeat">
              Repeat Password<span class="text-red-500">*</span>
            </label>
            <input
              class="focus:shadow-outline w-full appearance-none rounded border py-2 px-3 leading-tight text-gray-700 shadow focus:outline-none"
              id="password_repeat"
              maxlength="15"
              minlength="5"
              name="password_repeat"
              type="password"
              required
              placeholder="Enter your password again" />
          </div>
          <div class="mb-5 text-right text-sm text-red-500">{{ error }}</div>
          <div class="mb-4 text-right">
            <label for="consent_privacy" class="leading-tight text-gray-700">
              I consent to the <a href="{{ url_for('privacypolicy') }}" class="text-teal-500 hover:text-violet-400">Privacy Policy</a> of
              this survey website.<span class="text-red-500">*</span>
              <input id="consent_privacy" type="checkbox" name="consent_privacy" required
            /></label>
          </div>
          <div class="mb-4 text-right">
            <label for="consent_survey" class="leading-tight text-gray-700">
              I agree to participate in this research study, I feel that I understand what will happen if I take part, and I understand that
              I can leave at any time.<span class="text-red-500">*</span>
              <input id="consent_survey" type="checkbox" name="consent_survey" required
            /></label>
          </div>

          <div class="mb-6 flex items-center justify-end">
            <button
              id="submit"
              class="group cursor-pointer focus:shadow-outline flex items-center justify-center whitespace-nowrap rounded bg-teal-500 py-2 px-4 font-bold text-white hover:bg-gradient-to-r from-teal-500 to-violet-500 focus:outline-none"
              type="submit">
              <div class="group-hover:-translate-x-2">Register</div>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke-width="1.5"
                stroke="currentColor"
                class="group-hover:-translate-x-1 -mr-4 h-4 w-4 scale-0 group-hover:scale-100">
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10" />
              </svg>
            </button>
          </div>
        </div>
      </form>
      <!-- Made with Love Slogan -->
      <div class="pb-2 flex text-xs text-gray-400 justify-center">
        <p>
          Made with ðŸ–¤ by
          <a href="https://martlgap.github.io" target="_blank" class="text-gray-600 hover:text-violet-400">Martl</a>
          and
          <a href="https://chat.openai.com" target="_blank" class="text-gray-600 hover:text-violet-400">ChatGPT</a>
        </p>
      </div>
    </div>
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    var usernameInput = document.getElementById("username");
    var statusDiv = document.getElementById("username-status");
    var buttonDiv = document.getElementById("submit");

    usernameInput.addEventListener("keyup", function () {
      var username = usernameInput.value;

      var xhr = new XMLHttpRequest();
      xhr.open("POST", "/check_username");
      xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
      xhr.onload = function () {
        if (xhr.status === 200) {
          var response = JSON.parse(xhr.responseText);
          if (response.available) {
            statusDiv.textContent = "";
            if (buttonDiv.classList.contains("bg-slate-300")) {
              buttonDiv.classList.replace("bg-slate-300", "bg-teal-500");
            }
            buttonDiv.style.cursor = "pointer";
            buttonDiv.disabled = false;
          } else {
            statusDiv.textContent = "Username not available!";
            if (buttonDiv.classList.contains("bg-teal-500")) {
              buttonDiv.classList.replace("bg-teal-500", "bg-slate-300");
            }
            buttonDiv.style.cursor = "not-allowed";
            buttonDiv.disabled = true;
          }
        }
      };
      xhr.send("username=" + encodeURIComponent(username));
    });
  });
</script>

<script>
  const passwordInput = document.getElementById("password");

  // Store the scroll position before the password input is focused
  let scrollPosition = 0;
  passwordInput.addEventListener("focus", () => {
    scrollPosition = window.pageYOffset || document.documentElement.scrollTop;
  });

  // Restore the scroll position after the password input is blurred
  passwordInput.addEventListener("blur", () => {
    window.scrollTo(0, scrollPosition);
  });
</script>

